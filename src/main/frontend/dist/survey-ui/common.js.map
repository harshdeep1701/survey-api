{"version":3,"file":"common.js","mappings":"sJAQO,IAAMA,EAAwB,MAA/B,MAAOA,EAIXC,YAAoBC,GAAAC,KAAAD,OAFHC,KAAAC,KAAO,GAAGC,IAAYC,wBAEC,CAGxCC,aAAaC,GACX,OAAOL,KAAKD,KAAKO,IAAsB,GAAGN,KAAKC,QAAQI,cACzD,CAOAE,eAAeF,EAAkBG,GAC/B,MAAMC,EAAO,IAAIC,SAGXC,EAAe,IAAIC,KAAK,CAACC,KAAKC,UAAUN,EAAQO,WAAY,CAChEC,KAAM,qBAERP,SAAKQ,OAAO,WAAYN,EAAc,iBAElCH,EAAQU,MACVT,EAAKQ,OAAO,OAAQT,EAAQU,MAGvBlB,KAAKD,KAAKoB,KAAqB,GAAGnB,KAAKC,QAAQI,cAAsBI,EAC9E,CAGAW,qBACEf,EACAgB,EACAH,GAEA,OAAOlB,KAAKO,eAAeF,EAAU,CAAEU,SAAUM,EAAKH,QACxD,CAEAI,eAAejB,GAEbkB,OAAOC,KADK,GAAGxB,KAAKC,QAAQI,qBACX,SACnB,iDA5CWR,GAAwB4B,MAAAC,MAAA,sCAAxB7B,EAAwB8B,QAAxB9B,EAAwB+B,UAAAC,WADX,QAAM,SACnBhC,CAAwB","names":["SurveyResponseApiService","constructor","http","this","base","environment","apiBaseUrl","getResponses","surveyId","get","submitResponse","payload","form","FormData","responseBlob","Blob","JSON","stringify","response","type","append","file","post","submitResponseObject","dto","downloadExport","window","open","i0","i1","factory","Éµfac","providedIn"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./src/app/services/survey-response-api.service.ts"],"sourcesContent":["// src/app/services/survey-response-api.service.ts\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../environments/environment';\r\nimport { SurveyResponse, SurveyUploadRequest, SurveyResponseSaveRequest } from '../models/api-model';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class SurveyResponseApiService {\r\n  /** Per spec server url includes context path */\r\n  private readonly base = `${environment.apiBaseUrl}/api/surveys`;\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  /** GET /api/surveys/{surveyId}/responses */\r\n  getResponses(surveyId: number): Observable<SurveyResponse[]> {\r\n    return this.http.get<SurveyResponse[]>(`${this.base}/${surveyId}/responses`);\r\n  }\r\n\r\n  /**\r\n   * POST /api/surveys/{surveyId}/responses (multipart/form-data)\r\n   *  - \"response\": JSON object (content-type application/json) of SurveyResponseSaveRequest\r\n   *  - \"file\": optional binary\r\n   */\r\n  submitResponse(surveyId: number, payload: SurveyUploadRequest): Observable<SurveyResponse> {\r\n    const form = new FormData();\r\n\r\n    // Attach response as application/json blob\r\n    const responseBlob = new Blob([JSON.stringify(payload.response)], {\r\n      type: 'application/json',\r\n    });\r\n    form.append('response', responseBlob, 'response.json');\r\n\r\n    if (payload.file) {\r\n      form.append('file', payload.file);\r\n    }\r\n\r\n    return this.http.post<SurveyResponse>(`${this.base}/${surveyId}/responses`, form);\r\n  }\r\n\r\n  /** Convenience helper if you only have the DTO + optional file */\r\n  submitResponseObject(\r\n    surveyId: number,\r\n    dto: SurveyResponseSaveRequest,\r\n    file?: File\r\n  ): Observable<SurveyResponse> {\r\n    return this.submitResponse(surveyId, { response: dto, file });\r\n  }\r\n\r\n  downloadExport(surveyId: number) {\r\n    const url = `${this.base}/${surveyId}/responses/export`;\r\n    window.open(url, '_blank');\r\n  }\r\n}\r\n"],"x_google_ignoreList":[]}